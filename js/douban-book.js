function bookShow(e,o,a){var t=localStorage.getItem(o),r=JSON.parse(t),l=r.rating||8,s=toPercent(l/10),n=r.cover_image_url,i=r.title,d="";d+=`<div class="dfdORB"><div class="sc-hKFxyN HPRth"><div class="lazyload-wrapper"><img class="avatar" src="${n}" referrer-policy="no-referrer" loading="lazy" alt="${i}" title="${i}" width="150" height="220" /></div></div><div class="sc-fujyAs eysHZq"><div class="rating"><span class="allstardark"><span class="allstarlight" style="width:${s}"></span></span><span class="rating_nums">${l}</span></div></div><div class="sc-iCoGMd kMthTr"><a rel="noreferrer" href="${e}" target="_blank">${i}</a></div></div>`,a&&a.insertAdjacentHTML("beforeend",d)}function toPercent(e){var o=Number(100*e).toFixed(1);return o+="%"}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("#douban-book")||"";let o="";function a(a,t){let r=0;a.forEach(a=>{if(a&&r<t){var l=a.item,s=l.category,n=l.uuid;r++;var i=s+"-"+n,d=o+l.url;null==localStorage.getItem(i)||"undefined"===localStorage.getItem(i)?(localStorage.setItem(i,JSON.stringify(l)),bookShow(d,i,e)):bookShow(d,i,e)}}),window.Lately&&Lately.init({target:".photo-time"})}e&&function(e){var t="";"undefined"!=typeof myBooks&&(t=myBooks.url,o=myBooks.domain);let r=e||8;var l=JSON.parse(localStorage.getItem("doubanBookUpdated"))||"",s=JSON.parse(localStorage.getItem("doubanBookData"))||"";s?(a(s,r),console.log("memosDoubanBook 本地数据加载成功")):localStorage.setItem("doubanBookUpdated","");fetch(t).then(e=>e.json()).then(e=>{var o=leonus.formatTimestamp(Date.parse(e.data[0].created_time)/1e3);if(o&&l!=o){var t=e.data;a(t,r),localStorage.setItem("doubanBookUpdated",JSON.stringify(o)),localStorage.setItem("doubanBookData",JSON.stringify(t)),console.log("memosDoubanBook 热更新完成")}else console.log("memosDoubanBook API 数据未更新")})}(5)});
!function(){function e(e,t){console.log(Date.now(),e,t.getAttribute("data-src"))}new LazyLoad({class_applied:"lz-applied",class_loading:"lz-loading",class_loaded:"lz-loaded",class_error:"lz-error",class_entered:"lz-entered",class_exited:"lz-exited",callback_enter:function(t){e("üîë ENTERED",t)},callback_exit:function(t){e("üö™ EXITED",t)},callback_cancel:function(t){e("üî• CANCEL",t)},callback_loading:function(t){e("‚åö LOADING",t)},callback_loaded:function(t){e("üëç LOADED",t)},callback_error:function(t){e("üíÄ ERROR",t),t.src="/assets/img/error.png"},callback_finish:function(){e("‚úîÔ∏è FINISHED",document.documentElement)}})}();const TAG_REG=/#([^\s#]+?)\s/g,BILIBILI_REG=/<a\shref="https:\/\/www\.bilibili\.com\/video\/((av[\d]{1,10})|(BV([\w]{10})))\/?">.*<\/a>/g,NETEASE_MUSIC_REG=/<a\shref="https:\/\/music\.163\.com\/.*id=([0-9]+)".*?>.*<\/a>/g,QQMUSIC_REG=/<a\shref="https\:\/\/y\.qq\.com\/.*(\/[0-9a-zA-Z]+)(\.html)?".*?>.*?<\/a>/g,QQVIDEO_REG=/<a\shref="https:\/\/v\.qq\.com\/.*\/([a-z|A-Z|0-9]+)\.html".*?>.*<\/a>/g,SPOTIFY_REG=/<a\shref="https:\/\/open\.spotify\.com\/(track|album)\/([\s\S]+)".*?>.*<\/a>/g,YOUKU_REG=/<a\shref="https:\/\/v\.youku\.com\/.*\/id_([a-z|A-Z|0-9|==]+)\.html".*?>.*<\/a>/g,YOUTUBE_REG=/<a\shref="https:\/\/www\.youtube\.com\/watch\?v\=([a-z|A-Z|0-9]{11})\".*?>.*<\/a>/g,MARKDOWN_PICS=/\!\[.*?\]\(.*?\)/g,ANTI_REFS=/```([\W\w]+)```/g,HTML_PRE=/\<pre\>[\W\w]+\<\/pre\>/g,MARKED_JS_PICS=/\<div class\=\"waterfall\" id\=\"encrypt\-blog\"\>.*\<\/div\>/g;var limit=memos.limit,memoUrl=memos.host+memos.path+"?creatorId="+memos.creatorId+"&rowStatus=NORMAL",page=1,offset=0,nextLength=0,nextDom="",tag="",btnRemove=0,memoDom=document.querySelector(memos.domId),load='<button class="load-btn button-load">Âä™ÂäõÂä†ËΩΩ‰∏≠‚Ä¶‚Ä¶</button>';if(memoDom){memoDom.insertAdjacentHTML("afterend",load),getFirstList(),btnRemove=0;var btn=document.querySelector("button.button-load");btn.addEventListener("click",function(){if(btn.textContent="Âä™ÂäõÂä†ËΩΩ‰∏≠‚Ä¶‚Ä¶",updateHTMl(nextDom),nextLength<limit)return document.querySelector("button.button-load").remove(),void(btnRemove=1);getNextList()})}function getFirstList(){fetch(memoUrl+"&limit="+limit).then(e=>e.json()).then(e=>{if(updateTwikoo(e),e.length<limit)return document.querySelector("button.button-load").remove(),void(btnRemove=1);page++,offset=limit*(page-1),getNextList()})}function getNextList(){if(tag)var e=memoUrl+"&limit="+limit+"&offset="+offset+"&tag="+tag;else e=memoUrl+"&limit="+limit+"&offset="+offset;fetch(e).then(e=>e.json()).then(e=>{if(nextLength=(nextDom=e).length,page++,offset=limit*(page-1),nextLength<1)return document.querySelector("button.button-load").remove(),void(btnRemove=1)})}function getTagFirstList(){page=1,offset=0,nextLength=0,nextDom="",memoDom.innerHTML="",fetch(memoUrl+"&limit="+limit+"&tag="+tag).then(e=>e.json()).then(e=>{if(updateTwikoo(e),e.length<limit)return document.querySelector("button.button-load").remove(),void(btnRemove=1);page++,offset=limit*(page-1),getNextList()})}function updateTwikoo(e){var t=e.map(e=>memos.host+"m/"+e.id);twikoo.getCommentsCount({envId:envId,urls:t,includeReply:!0}).then(function(t){!function(t){var o=t.map(e=>Object.assign({},{count:e.count}));updateHTMl(e.map((e,t)=>({...e,...o[t]})))}(t)}).catch(function(e){console.error(e)})}function updateHTMl(e,t){var o,a="";marked.setOptions({breaks:!0,smartypants:!0,langPrefix:"language-",highlight:function(e,t){const o=hljs.getLanguage(t)?t:"plaintext";return hljs.highlight(e,{language:o}).value}});for(var i=!1,r=0;r<e.length;r++){var n=e[r].content.replace(TAG_REG,"<span class='tag-span'><a rel='noopener noreferrer' href='#$1'>#$1</a></span>");n.indexOf("#Áõ∏ÂÜå")>0&&(i=!0),n=marked.parse(pangu.spacing(n)).replace(BILIBILI_REG,"<div class='video-wrapper'><iframe src='//player.bilibili.com/player.html?bvid=$1&as_wide=1&high_quality=1&danmaku=0' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' style='position:absolute;height:100%;width:100%;'></iframe></div>").replace(YOUTUBE_REG,"<div class='video-wrapper'><iframe src='https://www.youtube.com/embed/$1' title='YouTube video player' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen title='YouTube Video'></iframe></div>").replace(NETEASE_MUSIC_REG,"<meting-js auto='https://music.163.com/#/song?id=$1'></meting-js>").replace(QQMUSIC_REG,"<meting-js auto='https://y.qq.com/n/yqq/song$1.html'></meting-js>").replace(QQVIDEO_REG,"<div class='video-wrapper'><iframe src='//v.qq.com/iframe/player.html?vid=$1' allowFullScreen='true' frameborder='no'></iframe></div>").replace(SPOTIFY_REG,"<div class='spotify-wrapper'><iframe style='border-radius:12px' src='https://open.spotify.com/embed/$1/$2?utm_source=generator&theme=0' width='100%' frameBorder='0' allowfullscreen='' allow='autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture' loading='lazy'></iframe></div>").replace(YOUKU_REG,"<div class='video-wrapper'><iframe src='https://player.youku.com/embed/$1' frameborder=0 'allowfullscreen'></iframe></div>").replace(YOUTUBE_REG,"<div class='video-wrapper'><iframe src='https://www.youtube.com/embed/$1' title='YouTube video player' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen title='YouTube Video'></iframe></div>"),n+=leonus.procBiBi(memos.host,e[r],"resimg",envId),i&&(n=n.replace(MARKDOWN_PICS,"").replace(ANTI_REFS,"").replace(HTML_PRE,""),i=!1),n=n.replace(MARKED_JS_PICS,"");var l=e[r].pinned;let t="";l&&(t+='<div title="ÁΩÆÈ°∂"><svg class="memos__verify" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#icon-a744ea7b4e0022c)"><path d="M10.6963 17.5042C13.3347 14.8657 16.4701 14.9387 19.8781 16.8076L32.62 9.74509L31.8989 4.78683L43.2126 16.1005L38.2656 15.3907L31.1918 28.1214C32.9752 31.7589 33.1337 34.6647 30.4953 37.3032C30.4953 37.3032 26.235 33.0429 22.7171 29.525L6.44305 41.5564L18.4382 25.2461C14.9202 21.7281 10.6963 17.5042 10.6963 17.5042Z" fill="none" stroke="#333" stroke-width="4" stroke-linejoin="round"/></g><defs><clipPath id="icon-a744ea7b4e0022c"><rect width="48" height="48" fill="#333"/></clipPath></defs></svg></div>');let o=procBtns(memos.host,e[r].id,l);a+='<li class="timeline"><div class="memos__content"><div class="memos__text"><div class="memos__userinfo"><div>'+memos.name+'</div><div class="memos__svg"><div title="ËÆ§ËØÅË¥¶Âè∑"><svg viewBox="0 0 24 24" class="memos__verify"><g><path d="M22.5 12.5c0-1.58-.875-2.95-2.148-3.6.154-.435.238-.905.238-1.4 0-2.21-1.71-3.998-3.818-3.998-.47 0-.92.084-1.336.25C14.818 2.415 13.51 1.5 12 1.5s-2.816.917-3.437 2.25c-.415-.165-.866-.25-1.336-.25-2.11 0-3.818 1.79-3.818 4 0 .494.083.964.237 1.4-1.272.65-2.147 2.018-2.147 3.6 0 1.495.782 2.798 1.942 3.486-.02.17-.032.34-.032.514 0 2.21 1.708 4 3.818 4 .47 0 .92-.086 1.335-.25.62 1.334 1.926 2.25 3.437 2.25 1.512 0 2.818-.916 3.437-2.25.415.163.865.248 1.336.248 2.11 0 3.818-1.79 3.818-4 0-.174-.012-.344-.033-.513 1.158-.687 1.943-1.99 1.943-3.484zm-6.616-3.334l-4.334 6.5c-.145.217-.382.334-.625.334-.143 0-.288-.04-.416-.126l-.115-.094-2.415-2.415c-.293-.293-.293-.768 0-1.06s.768-.294 1.06 0l1.77 1.767 3.825-5.74c.23-.345.696-.436 1.04-.207.346.23.44.696.21 1.04z"></path></g></svg></div>'+t+'</div><div class="memos__id">@'+memos.username+"</div>"+o+"</div><p>"+n+'</p></div><div class="memos__meta"><small class="memos__date">'+moment(1e3*e[r].createdTs).twitter()+' ‚Ä¢ Êù•Ëá™„Äå<a href="'+memos.host+"m/"+e[r].id+'" target="_blank">Èë´Èë´ÂøÉÊÉÖ</a>„Äç</small></div></div></li>'}o='<ul id="memosList">'+a+"</ul>",t?document.querySelector("#memosList").insertAdjacentHTML("afterbegin",a):memoDom.insertAdjacentHTML("beforeend",o),document.querySelector("button.button-load")&&(document.querySelector("button.button-load").textContent="Âä†ËΩΩÊõ¥Â§ö")}function procBtns(e,t,o){let a=leonus.getBtnSet(e,t,o);return a?`\n        <div class="btnsContainer">\n            <span class="more-action-btn" onclick="showBtns('btns_${t}')"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon-img"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg></span>\n        </div>\n        <div class="more-action-btns-wrapper d-none" id="btns_${t}">\n            <div class="more-action-btns-container min-w-[6em]">${a}</div>\n       </div>`:""}function showBtns(e){$(".more-action-btns-wrapper:not(.d-none):not(#"+e+")").addClass("d-none"),$("#"+e).toggleClass("d-none")}function fetchDB(){var e="https://douban-api.edui.fun/",t=document.querySelectorAll(".timeline a[href*='douban.com/subject/']:not([rel='noreferrer'])")||"";if(t)for(var o=0;o<t.length;o++){_this=t[o];var a=_this.href,i=/^https\:\/\/(movie|book)\.douban\.com\/subject\/([0-9]+)\/?/,r=a.replace(i,"$1"),n=a.replace(i,"$2").toString();if("movie"===r){var l="movie"+n,s=e+"movies/"+n;null==localStorage.getItem(l)||"undefined"===localStorage.getItem(l)?fetch(s).then(e=>e.json()).then(e=>{let t="movies"+e.sid,o="https://movie.douban.com/subject/"+e.sid+"/";localStorage.setItem(t,JSON.stringify(e)),movieShow(o,t)}):movieShow(a,l)}else if("book"===r){l="book"+n,s=e+"v2/book/id/"+n;null==localStorage.getItem(l)||"undefined"===localStorage.getItem(l)?fetch(s).then(e=>e.json()).then(e=>{let t="book"+e.id,o="https://book.douban.com/subject/"+e.id+"/";localStorage.setItem(t,JSON.stringify(e)),bookShow(o,t)}):bookShow(a,l)}}}function movieShow(e,t){var o=localStorage.getItem(t),a=JSON.parse(o),i=Math.ceil(a.rating),r="<div class='post-preview'><div class='post-preview--meta'><div class='post-preview--middle'><h4 class='post-preview--title'><a target='_blank' rel='noreferrer' href='"+e+"'>„Ää"+a.name+"„Äã</a></h4><div class='rating'><div class='rating-star allstar"+i+"'></div><div class='rating-average'>"+a.rating+"</div></div><time class='post-preview--date'>ÂØºÊºîÔºö"+a.director+" / Á±ªÂûãÔºö"+a.genre+" / "+a.year+"</time><section class='post-preview--excerpt'>"+a.intro.replace(/\s*/g,"")+"</section></div></div><img referrer-policy='no-referrer' loading='lazy' class='post-preview--image' src="+a.img+"></div>",n=document.createElement("div"),l=".timeline a[href='"+e+"']",s=document.querySelector(l);s.parentNode.replaceChild(n,s),n.innerHTML=r}function bookShow(e,t){var o=localStorage.getItem(t),a=JSON.parse(o),i=Math.ceil(a.rating.average),r="<div class='post-preview'><div class='post-preview--meta'><div class='post-preview--middle'><h4 class='post-preview--title'><a target='_blank' rel='noreferrer' href='"+e+"'>„Ää"+a.title+"„Äã</a></h4><div class='rating'><div class='rating-star allstar"+i+"'></div><div class='rating-average'>"+a.rating.average+"</div></div><time class='post-preview--date'>‰ΩúËÄÖÔºö"+a.author+" </time><section class='post-preview--excerpt'>"+a.summary.replace(/\s*/g,"")+"</section></div></div><img referrer-policy='no-referrer' loading='lazy' class='post-preview--image' src="+a.images.medium+"></div>",n=document.createElement("div"),l=".timeline a[href='"+e+"']",s=document.querySelector(l);s.parentNode.replaceChild(n,s),n.innerHTML=r}function getTotal(){var e=memos.host+memos.path+"/stats?creatorId="+memos.creatorId;fetch(e).then(e=>e.json()).then(e=>{if(e){var t=e.length;document.getElementById("total").innerHTML=t}}).catch(e=>{})}document.addEventListener("click",function(e){var t=e.target;if(t&&"a"===t.tagName.toLowerCase()&&t.getAttribute("href")&&t.getAttribute("href").startsWith("#")){if(e.preventDefault(),tag=t.getAttribute("href").substring(1).trim(),btnRemove){btnRemove=0,memoDom.insertAdjacentHTML("afterend",load);var o=document.querySelector("button.button-load");o.addEventListener("click",function(){if(o.textContent="Âä™ÂäõÂä†ËΩΩ‰∏≠‚Ä¶‚Ä¶",updateHTMl(nextDom),nextLength<limit)return document.querySelector("button.button-load").remove(),void(btnRemove=1);getNextList()})}getTagFirstList(),document.getElementById("tag-filter").style.display="block";var a=document.getElementById("tags"),i=`Filter: <span class='tag-span'><a rel='noopener noreferrer' href=''>#${tag}</a></span>`;a.innerHTML=i,scrollTo(0,0)}for(var r=document.getElementsByClassName("btnsContainer"),n=document.getElementsByClassName("more-action-btns-wrapper"),l=!1,s=0;s<r.length;s++)if(t===r[s]||r[s].contains(t)){l=!0;break}if(!l)for(s=0;s<n.length;s++)n[s].classList.contains("d-none")||n[s].classList.add("d-none")}),window.ViewImage&&ViewImage.init(".container img"),window.onload=getTotal();const localTheme=window.localStorage&&window.localStorage.getItem("theme"),themeToggle=document.querySelector(".theme-toggle"),postToggle=document.querySelector("#toggleButton");localTheme&&(document.body.classList.remove("light-theme","dark-theme"),document.body.classList.add(localTheme)),themeToggle.addEventListener("click",()=>{const e=!new RegExp("(dark|light)-theme").test(document.body.className),t=window.matchMedia("(prefers-color-scheme: dark)").matches;e?t?document.body.classList.add("light-theme"):document.body.classList.add("dark-theme"):(document.body.classList.toggle("light-theme"),document.body.classList.toggle("dark-theme")),window.localStorage&&window.localStorage.setItem("theme",document.body.classList.contains("dark-theme")?"dark-theme":"light-theme")}),postToggle.addEventListener("click",()=>{$("#memoPage").toggleClass("d-none");let e=!0;e=!!$("#memoPage").hasClass("d-none"),localStorage.setItem("memos-editor-display",e)});
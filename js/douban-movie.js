function movieShow(e,t,a){var o=localStorage.getItem(t),i=JSON.parse(o),r=i.rating||8,s=toPercent(r/10),l=i.cover_image_url,n=i.title,d="";d+=`<div class="dfdORB"><div class="sc-hKFxyN HPRth"><div class="lazyload-wrapper"><img class="avatar" src="${l}" referrer-policy="no-referrer" loading="lazy" title="${n}" width="150" height="220" /></div></div><div class="sc-fujyAs eysHZq"><div class="rating"><span class="allstardark"><span class="allstarlight" style="width:${s}"></span></span><span class="rating_nums">${r}</span></div></div><div class="sc-iCoGMd kMthTr"><a rel="noreferrer" href="${e}" target="_blank">${n}</a></div></div>`,a&&a.insertAdjacentHTML("beforeend",d)}function toPercent(e){var t=Number(100*e).toFixed(1);return t+="%"}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("#douban-movie")||"";let t="";function a(a,o){let i=0;a.forEach(a=>{if(a&&i<o){var r=a.item,s=r.category,l=r.uuid;i++;var n=s+"-"+l,d=t+r.url;null==localStorage.getItem(n)||"undefined"===localStorage.getItem(n)?(localStorage.setItem(n,JSON.stringify(r)),movieShow(d,n,e)):movieShow(d,n,e)}}),window.Lately&&Lately.init({target:".photo-time"})}e&&function(o){let i="";"undefined"!=typeof myMovies&&(i=myMovies.url,t=myMovies.domain);let r=o||8;var s=JSON.parse(localStorage.getItem("movieLastUpdatedTime"))||"",l=JSON.parse(localStorage.getItem("movieDatas"))||"";l?(a(l,r),console.log("memosDoubanMovie 本地数据加载成功")):localStorage.setItem("movieLastUpdatedTime","");fetch(i).then(e=>e.json()).then(t=>{var o=leonus.formatTimestamp(Date.parse(t.data[0].created_time)/1e3);if(o&&s!=o){var i=t.data;e.innerHTML="",a(i,r),localStorage.setItem("movieLastUpdatedTime",JSON.stringify(o)),localStorage.setItem("movieDatas",JSON.stringify(i)),console.log("memosDoubanMovie 热更新完成")}else console.log("memosDoubanMovie API 数据未更新")})}(5)});
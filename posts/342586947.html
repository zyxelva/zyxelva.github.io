<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta name="keywords" content="【Docker学习】3.Dockerfile, Back-End Dev Java"><meta name="description" content="1 前言前两章，我们大致介绍了Docker的基础操作和常见命令，实际生产开发过程中，企业或组织都有自己的一套产品和应用，类似以前Windows出现过很多定制化的系统，如Ghost xxxx，深度等。那对于Docker构建的镜像，是怎么实现定"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="referrer" content="no-referrer-when-downgrade"><title>【Docker学习】3.Dockerfile | Kezade</title><link rel="icon" type="image/jpeg" href="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/medias/avatar/avatar2.jpg"><style>body{background-image:url(https://it-ark-dev.oss-cn-shenzhen.aliyuncs.com/464e9ac7a5a729ae67f91f7cf0cf6fe2.jpg);background-repeat:no-repeat;background-attachment:fixed;background-size:cover;background-position:center center}</style><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/awesome/css/all.min.css"><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/materialize/materialize.min.css"><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/aos/aos.css"><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/animate/animate.min.css"><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zyxelva/picgo@v3.1/css/matery.css?v3"><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/css/my.css"><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/css/dark.css" media="none" onload='"all"!=media&&(media="all")'><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/tocbot/tocbot.css"><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/css/post.css"><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/css/reward.css"><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/jquery/jquery-3.6.0.min.js"></script><script src="https://gcore.jsdelivr.net/gh/zyxelva/picgo@v3.3/js/function.js?v88"></script><script src="https://gcore.jsdelivr.net/gh/zyxelva/picgo@v1.3/js/imgStatus.min.js"></script><script src="https://gcore.jsdelivr.net/gh/zyxelva/picgo@v1.3/js/waterfall.min.js"></script><script src="https://gcore.jsdelivr.net/gh/zyxelva/picgo@v1.3/js/lately.min.js"></script><script>var memos={host:"https://s.dusays.com/",limit:"10",creatorId:"49",username:"zyxelva",name:"Kezade",domId:"#memos",path:"api/v1/memo"},douban={api:"https://douban-api.edui.fun/"}</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/rss2.xml" title="Kezade" type="application/rss+xml"></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/medias/avatar/avatar2.jpg" class="logo-img k-avatar" alt="LOGO"> <span class="logo-span">Kezade</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:0.6"></i> <span>首页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="" class="waves-effect waves-light"><i class="fa-solid fa-newspaper" style="zoom:0.6"></i> <span>文章</span><i class="fas fa-chevron-down" aria-hidden="true" style="zoom:0.6"></i></a><ul class="sub-nav menus_item_child"><li><a href="/tags"><i class="fas fa-tags" style="margin-top:-20px;zoom:0.6"></i> <span>标签</span></a></li><li><a href="/categories"><i class="fas fa-bookmark" style="margin-top:-20px;zoom:0.6"></i> <span>分类</span></a></li><li><a href="/archives"><i class="fas fa-archive" style="margin-top:-20px;zoom:0.6"></i> <span>归档</span></a></li></ul></li><li class="hide-on-med-and-down nav-item"><a href="" class="waves-effect waves-light"><i class="fa-solid fa-sitemap" style="zoom:0.6"></i> <span>系列</span><i class="fas fa-chevron-down" aria-hidden="true" style="zoom:0.6"></i></a><ul class="sub-nav menus_item_child"><li><a href="/categories/%E7%AE%97%E6%B3%95"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>算法学习</span></a></li><li><a href="/categories/RocketMQ%E5%AD%A6%E4%B9%A0"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>RMQ学习</span></a></li><li><a href="/categories/Netty%E5%AD%A6%E4%B9%A0"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>Netty学习</span></a></li><li><a href="/categories/Spring%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>Spring学习</span></a></li><li><a href="/categories/JVM%E5%AD%A6%E4%B9%A0"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>JVM学习</span></a></li><li><a href="/categories/MySQL%E5%AD%A6%E4%B9%A0"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>MySQL学习</span></a></li><li><a href="/categories/MyBatis%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>MyBatis学习</span></a></li><li><a href="/categories/Zookeeper%E5%AD%A6%E4%B9%A0"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>ZK学习</span></a></li><li><a href="/categories/Hexo"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>Hexo学习</span></a></li><li><a href="/categories/Redis%E5%AD%A6%E4%B9%A0"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>Redis学习</span></a></li><li><a href="/categories/Docker%E5%AD%A6%E4%B9%A0"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>Docker学习</span></a></li><li><a href="/categories/AP-Calculus"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>AP学习</span></a></li><li><a href="/categories/A-Level"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>A-Level学习</span></a></li><li><a href="/categories/SAT"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>SAT学习</span></a></li><li><a href="/categories/%E8%80%83%E7%A0%94"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>考研</span></a></li><li><a href="/categories/OSSD"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>OSSD</span></a></li><li><a href="/categories/%E9%AB%98%E8%80%83"><i class="fa-solid fa-rocket" style="margin-top:-20px;zoom:0.6"></i> <span>高考</span></a></li></ul></li><li class="hide-on-med-and-down nav-item"><a href="" class="waves-effect waves-light"><i class="fa-solid fa-place-of-worship" style="zoom:0.6"></i> <span>我的</span><i class="fas fa-chevron-down" aria-hidden="true" style="zoom:0.6"></i></a><ul class="sub-nav menus_item_child"><li><a href="/galleries"><i class="fas fa-image" style="margin-top:-20px;zoom:0.6"></i> <span>相册</span></a></li><li><a href="/bibi"><i class="fa-fw fa-solid fa-cloud-rain" style="margin-top:-20px;zoom:0.6"></i> <span>哔哔</span></a></li><li><a href="/todolist"><i class="fa-fw fa-solid fa-circle-check" style="margin-top:-20px;zoom:0.6"></i> <span>清单</span></a></li><li><a href="/musics"><i class="fas fa-music" style="margin-top:-20px;zoom:0.6"></i> <span>音乐</span></a></li></ul></li><li class="hide-on-med-and-down nav-item"><a href="" class="waves-effect waves-light"><i class="fa-solid fa-circle-info" style="zoom:0.6"></i> <span>更多</span><i class="fas fa-chevron-down" aria-hidden="true" style="zoom:0.6"></i></a><ul class="sub-nav menus_item_child"><li><a href="/contact"><i class="fas fa-comments" style="margin-top:-20px;zoom:0.6"></i> <span>留言</span></a></li><li><a href="/friends"><i class="fa-solid fa-link" style="margin-top:-20px;zoom:0.6"></i> <span>友链</span></a></li><li><a href="/friend-circle"><i class="fa-solid fa-rss" style="margin-top:-20px;zoom:0.6"></i> <span>圈圈</span></a></li><li><a href="/about"><i class="fas fa-user-circle" style="margin-top:-20px;zoom:0.6"></i> <span>关于</span></a></li></ul></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="搜索" style="zoom:0.85"></i></a></li><li><a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式"><i id="sum-moon-icon" class="fas fa-sun" style="zoom:0.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/medias/avatar/avatar2.jpg" class="logo-img circle responsive-img"><div class="logo-name">Kezade</div><div class="logo-desc">7 年 Java 开发经验，其中 3 年以上大型系统架构设计经验，以及 2 年以上的团队管理经验 | 具有分布式、高并发、高可用、大数据量的系统架构设计以及研发经验 | 对 Zookeeper、Netty、Dubbo、Spring Cloud、 Spring 等开源框架源码有过深入研究，并且有一定的框架定制开发经验</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="javascript:;"><i class="fa-fw fa-solid fa-newspaper"></i> 文章<span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/tags" style="margin-left:75px"><i class="fa fas fa-tags" style="position:absolute;left:50px"></i> <span>标签</span></a></li><li><a href="/categories" style="margin-left:75px"><i class="fa fas fa-bookmark" style="position:absolute;left:50px"></i> <span>分类</span></a></li><li><a href="/archives" style="margin-left:75px"><i class="fa fas fa-archive" style="position:absolute;left:50px"></i> <span>归档</span></a></li></ul></li><li class="m-nav-item"><a href="javascript:;"><i class="fa-fw fa-solid fa-sitemap"></i> 系列<span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/categories/%E7%AE%97%E6%B3%95" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>算法学习</span></a></li><li><a href="/categories/RocketMQ%E5%AD%A6%E4%B9%A0" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>RMQ学习</span></a></li><li><a href="/categories/Netty%E5%AD%A6%E4%B9%A0" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>Netty学习</span></a></li><li><a href="/categories/Spring%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>Spring学习</span></a></li><li><a href="/categories/JVM%E5%AD%A6%E4%B9%A0" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>JVM学习</span></a></li><li><a href="/categories/MySQL%E5%AD%A6%E4%B9%A0" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>MySQL学习</span></a></li><li><a href="/categories/MyBatis%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>MyBatis学习</span></a></li><li><a href="/categories/Zookeeper%E5%AD%A6%E4%B9%A0" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>ZK学习</span></a></li><li><a href="/categories/Hexo" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>Hexo学习</span></a></li><li><a href="/categories/Redis%E5%AD%A6%E4%B9%A0" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>Redis学习</span></a></li><li><a href="/categories/Docker%E5%AD%A6%E4%B9%A0" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>Docker学习</span></a></li><li><a href="/categories/AP-Calculus" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>AP学习</span></a></li><li><a href="/categories/A-Level" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>A-Level学习</span></a></li><li><a href="/categories/SAT" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>SAT学习</span></a></li><li><a href="/categories/%E8%80%83%E7%A0%94" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>考研</span></a></li><li><a href="/categories/OSSD" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>OSSD</span></a></li><li><a href="/categories/%E9%AB%98%E8%80%83" style="margin-left:75px"><i class="fa fa-solid fa-rocket" style="position:absolute;left:50px"></i> <span>高考</span></a></li></ul></li><li class="m-nav-item"><a href="javascript:;"><i class="fa-fw fa-solid fa-place-of-worship"></i> 我的<span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/galleries" style="margin-left:75px"><i class="fa fas fa-image" style="position:absolute;left:50px"></i> <span>相册</span></a></li><li><a href="/bibi" style="margin-left:75px"><i class="fa fa-fw fa-solid fa-cloud-rain" style="position:absolute;left:50px"></i> <span>哔哔</span></a></li><li><a href="/todolist" style="margin-left:75px"><i class="fa fa-fw fa-solid fa-circle-check" style="position:absolute;left:50px"></i> <span>清单</span></a></li><li><a href="/musics" style="margin-left:75px"><i class="fa fas fa-music" style="position:absolute;left:50px"></i> <span>音乐</span></a></li></ul></li><li class="m-nav-item"><a href="javascript:;"><i class="fa-fw fa-solid fa-circle-info"></i> 更多<span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/contact" style="margin-left:75px"><i class="fa fas fa-comments" style="position:absolute;left:50px"></i> <span>留言</span></a></li><li><a href="/friends" style="margin-left:75px"><i class="fa fa-solid fa-link" style="position:absolute;left:50px"></i> <span>友链</span></a></li><li><a href="/friend-circle" style="margin-left:75px"><i class="fa fa-solid fa-rss" style="position:absolute;left:50px"></i> <span>圈圈</span></a></li><li><a href="/about" style="margin-left:75px"><i class="fa fas fa-user-circle" style="position:absolute;left:50px"></i> <span>关于</span></a></li></ul></li><li><div class="divider"></div></li><li><a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank"><i class="fab fa-github-square fa-fw"></i> Fork Me</a></li></ul></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#0f9d58;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style><a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a></nav></header><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/cryptojs/crypto-js.min.js"></script><script></script><style>:root{--post-bg-image:url('https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/medias/featureimages/6.jpg')}</style><div class="bg-cover pd-header post-cover"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">【Docker学习】3.Dockerfile</h1></div></div></div></div></div><main class="post-container content"><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/Docker/"><span class="chip bg-color">Docker</span></a> <a href="/tags/Dockerfile/"><span class="chip bg-color">Dockerfile</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/Docker%E5%AD%A6%E4%B9%A0/" class="post-category">Docker学习</a></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i> 发布日期:&nbsp;&nbsp; 2023-12-26</div><div class="info-break-policy"><i class="far fa-file-word fa-fw"></i> 文章字数:&nbsp;&nbsp; 3.6k</div><div class="info-break-policy"><i class="far fa-clock fa-fw"></i> 阅读时长:&nbsp;&nbsp; 14 分</div></div></div><hr class="clearfix"><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/prism/prism.min.css"><div class="card-content article-card-content"><div id="articleContent"><h1 id="1-前言"><a href="#1-前言" class="headerlink" title="1 前言"></a>1 前言</h1><p>前两章，我们大致介绍了Docker的基础操作和常见命令，实际生产开发过程中，企业或组织都有自己的一套产品和应用，类似以前Windows出现过很多定制化的系统，如Ghost xxxx，深度等。那对于Docker构建的镜像，是怎么实现定制化或个性化或一致性环境的镜像呢？本章将给予你答案。</p><h1 id="2-命令"><a href="#2-命令" class="headerlink" title="2 命令"></a>2 命令</h1><p>Dockerfile 由一行行<code>命令语句</code>组成，并且支持以 # 开头的注释行。使用<code>docker build</code>即可执行脚本构建镜像，自动地去做一些事（同类似于<code>travis-ci</code>中的<code>.travis.yml</code>）。</p><h2 id="2-1-格式"><a href="#2-1-格式" class="headerlink" title="2.1 格式"></a>2.1 格式</h2><p>Dockerfile 的格式统一为：<br><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token comment"># Comment</span>
INSTRUCTION arguments<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></p><blockquote><p>注意：必须以<code>FROM BASE_IMAGE</code>开头指定基础镜像！！！除开<code>解析器指令</code>、<code>注释</code>和<code>具有全局作用域的ARG</code>。</p></blockquote><h2 id="2-2-语法"><a href="#2-2-语法" class="headerlink" title="2.2 语法"></a>2.2 语法</h2><p>Dockerfile 基本的语法如下：</p><ul><li>使用 # 来注释</li><li><code>MAINTAINER</code>：镜像作者信息，新版本已废弃。推荐使用<code>LABEL</code>指令；</li><li><code>LABEL</code>：添加镜像的元数据，使用<code>键值对</code>的形式；</li><li><code>FROM</code>：指令告诉 Docker 使用哪个镜像作为基础；</li><li><code>RUN</code>：开头的指令会在创建中运行，比如安装一个软件包，在这里使用 yum 来安装了一些软件；</li><li><code>COPY</code>：从 Docker 宿主机复制文件至创建的新镜像文件；</li><li><code>ADD</code>：类似于 COPY 指令，ADD 支持 tar 文件和 URL 路径；</li><li><code>WORKDIR</code>：用于为 Dockerfile 中所有的 RUN、CMD、ENTRYPOINT、COPY、ADD 指定设定工作目录；</li><li><code>VOLUME</code>：数据卷，用于在 image 中创建挂载点目录，以挂载 Docker host 上的卷或者其他容器上的卷；</li><li><code>EXPOSE</code>：为容器打开指定的监听端口以实现与外部通信；</li><li><code>ENV</code>：用于为镜像定义所需的环境变量，可以被 Dockerfile 文件中其他命令调用(ENV、ADD、COPY、RUN、CMD)；</li><li><code>ARG</code>：定义在构建过程中传递给构建器的变量，可使用<code>docker build</code>命令设置；</li><li><code>CMD</code>：启动容器指定默认要运行的程序或命令，默认”/bin/sh -c”运行；</li><li><code>ENTRYPOINT</code>：类型 CMD 指令的功能，用于为容器指定默认运行程序或命令；</li><li><code>USER</code>：指定当前用户。</li></ul><p>下面介绍几个常用的命令，其他命令的具体用法，可参考官方文档，见文章末尾参考文献。</p><h3 id="2-2-1-FROM"><a href="#2-2-1-FROM" class="headerlink" title="2.2.1 FROM"></a>2.2.1 FROM</h3><p>指定基础镜像。</p><h4 id="2-2-1-1-格式"><a href="#2-2-1-1-格式" class="headerlink" title="2.2.1.1 格式"></a>2.2.1.1 格式</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">FROM</span> BASE_IMAGE</span>
<span class="token comment"># 或者</span>
<span class="token instruction"><span class="token keyword">FROM</span> BASE_IMAGE:Tag</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>第一条指令必须为<code>FROM</code>指令（参见2.1节说明）。并且，如果在同一个<code>Dockerfile</code>中创建多个镜像时，可以使用<code>多个 FROM 指令</code>（每个镜像一次）。</p></blockquote><h4 id="2-2-1-2-举例"><a href="#2-2-1-2-举例" class="headerlink" title="2.2.1.2 举例"></a>2.2.1.2 举例</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">FROM</span> centos:7</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2-2-2-RUN"><a href="#2-2-2-RUN" class="headerlink" title="2.2.2 RUN"></a>2.2.2 RUN</h3><p>构建镜像时执行的命令。</p><h4 id="2-2-2-1-格式"><a href="#2-2-2-1-格式" class="headerlink" title="2.2.2.1 格式"></a>2.2.2.1 格式</h4><ul><li><p>shell 格式：</p><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token comment">#shell 格式：</span>
<span class="token instruction"><span class="token keyword">RUN</span> &lt;命令行命令></span>
<span class="token comment"># &lt;命令行命令> 等同于，在终端操作的 shell 命令。</span>
<span class="token comment"># 例如：</span>
<span class="token comment"># RUN apt-get update</span>
<span class="token comment"># RUN apt-get install -y curl</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>exec 格式：</p><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">RUN</span> [<span class="token string">"可执行文件"</span>, <span class="token string">"参数1"</span>, <span class="token string">"参数2"</span>]</span>
<span class="token comment"># 例如：</span>
<span class="token comment"># RUN ["./test.php", "dev", "offline"] 等价于 RUN ./test.php dev offline</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li></ul><blockquote><p><code>shell格式</code>是最常用的，它允许您更轻松地将较长的指令分解为多行，可以使用<code>换行符转义符</code>或使用<code>heredocs</code>，例如：<br>RUN &lt;&lt;EOF<br>apt-get update<br>apt-get install -y curl<br>EOF</p><p>注意：Dockerfile 的指令每执行一次都会在 docker 上新建一层。所以过多无意义的层，会造成镜像膨胀过大。例如：<br>FROM centos<br>RUN yum -y install wget<br>RUN wget -O redis.tar.gz “<a target="_blank" rel="noopener" href="http://download.redis.io/releases/redis-5.0.3.tar.gz">http://download.redis.io/releases/redis-5.0.3.tar.gz</a>“<br>RUN tar -xvf redis.tar.gz</p><p>以上执行会创建 3 层镜像。可简化为以下格式：<br>FROM centos<br>RUN yum -y install wget \<br>&amp;&amp; wget -O redis.tar.gz “<a target="_blank" rel="noopener" href="http://download.redis.io/releases/redis-5.0.3.tar.gz">http://download.redis.io/releases/redis-5.0.3.tar.gz</a>“ \<br>&amp;&amp; tar -xvf redis.tar.gz<br>如上，以 &amp;&amp; 符号连接命令，这样执行后，只会创建 1 层镜像。</p></blockquote><h3 id="2-2-3-ENV"><a href="#2-2-3-ENV" class="headerlink" title="2.2.3 ENV"></a>2.2.3 ENV</h3><p>设置环境变量，定义了环境变量，那么在后续的指令中，就可以使用这个环境变量。</p><h4 id="2-2-3-1-格式"><a href="#2-2-3-1-格式" class="headerlink" title="2.2.3.1 格式"></a>2.2.3.1 格式</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">ENV</span> &lt;key> &lt;value></span>
<span class="token instruction"><span class="token keyword">ENV</span> &lt;key1>=&lt;value1> &lt;key2>=&lt;value2>...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="2-2-3-2-举例"><a href="#2-2-3-2-举例" class="headerlink" title="2.2.3.2 举例"></a>2.2.3.2 举例</h4><p>以下示例设置<code>NODE_VERSION = 7.2.0</code>， 在后续的指令中可以通过<code>$NODE_VERSION</code>引用：<br><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">ENV</span> NODE_VERSION 7.2.0</span>

<span class="token instruction"><span class="token keyword">RUN</span> curl -SLO <span class="token string">"https://nodejs.org/dist/v$NODE_VERSION/node-v$NODE_VERSION-linux-x64.tar.xz"</span> <span class="token operator">\</span>
&amp;&amp; curl -SLO <span class="token string">"https://nodejs.org/dist/v$NODE_VERSION/SHASUMS256.txt.asc"</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></p><h3 id="2-2-4-ARG"><a href="#2-2-4-ARG" class="headerlink" title="2.2.4 ARG"></a>2.2.4 ARG</h3><p>构建参数，与 ENV 作用一致。不过作用域不一样。ARG 设置的环境变量仅对 Dockerfile 内有效，也就是说只有<code>docker build</code>的过程中有效，构建好的镜像内不存在此环境变量。也称为<code>构建时变量</code>。</p><p>构建命令<code>docker build</code>中可以用<code>--build-arg &lt;参数名&gt;=&lt;值&gt;</code>来覆盖。</p><h4 id="2-2-4-1-格式"><a href="#2-2-4-1-格式" class="headerlink" title="2.2.4.1 格式"></a>2.2.4.1 格式</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">ARG</span> &lt;参数名>[=&lt;默认值>]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>如果在Dockerfile中期望使用各种ARG变量（无默认值），但在运行build命令时未提供任何变量，则会出现错误消息。<br>[Warning] One or more build-args [foo] were not consumed.</p><p>但是，在构建镜像后，可以通过查看镜像<code>docker history</code>来轻松检查ARG值。因此，对于敏感数据而言，它们是一个糟糕的选择。</p></blockquote><h4 id="2-2-4-2-举例"><a href="#2-2-4-2-举例" class="headerlink" title="2.2.4.2 举例"></a>2.2.4.2 举例</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">ARG</span> some_variable_name</span>
<span class="token comment"># or with a hard-coded default:</span>
<span class="token comment">#ARG some_variable_name=default_value</span>

<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">"Oh dang look at that $some_variable_name"</span></span>
<span class="token comment"># you could also use braces - $&#123;some_variable_name&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>从命令行构建Docker镜像时，可以使用<code>--build-arg</code>来设置ARG值：<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">docker</span> build --build-arg <span class="token assign-left variable">some_variable_name</span><span class="token operator">=</span>a_value<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><p>使用上述Dockerfile运行该命令将导致打印以下行（以及其他内容）：<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Oh dang <span class="token function">look</span> at that a_value<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><p>更多关于ARG的用法和注意事项，参考<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/builder/#arg">ARG官方文档</a></p><img src="https://gcore.jsdelivr.net/gh/zyxelva/picgo/markdown/docker_environment_build_args.png"><div class="caption"><b class="center-caption">ARG与ENV作用范围</b></div><p>ARG与ENV可用性与重写样例如下图所示：<br><img src="https://gcore.jsdelivr.net/gh/zyxelva/picgo/markdown/docker_environment_build_args_overview.png"></p><div class="caption"><b class="center-caption">ARG与ENV可用性概览和样例</b></div><p></p><h3 id="2-2-5-CMD"><a href="#2-2-5-CMD" class="headerlink" title="2.2.5 CMD"></a>2.2.5 CMD</h3><p>构建镜像后调用，也就是在<code>容器启动时</code>才进行调用。</p><blockquote><p>类似于 RUN 指令，用于运行程序，但二者运行的时间点不同:</p><ul><li>CMD 在<code>docker run</code>时运行。</li><li>RUN 是在<code>docker build</code>。</li></ul></blockquote><h4 id="2-2-5-1-格式"><a href="#2-2-5-1-格式" class="headerlink" title="2.2.5.1 格式"></a>2.2.5.1 格式</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">CMD</span> &lt;shell 命令> </span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"&lt;可执行文件或命令>"</span>,<span class="token string">"&lt;param1>"</span>,<span class="token string">"&lt;param2>"</span>,...] </span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"&lt;param1>"</span>,<span class="token string">"&lt;param2>"</span>,...]  # 该写法是为 ENTRYPOINT 指令指定的程序提供默认参数</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>推荐使用<code>第二种格式</code>，执行过程比较明确。第一种格式实际上在运行的过程中也会自动转换成第二种格式运行，并且默认可执行文件是 sh。</p><h4 id="2-2-5-2-举例"><a href="#2-2-5-2-举例" class="headerlink" title="2.2.5.2 举例"></a>2.2.5.2 举例</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">CMD</span> echo <span class="token string">"This is a test."</span> | wc -l</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"/usr/bin/wc"</span>,<span class="token string">"--help"</span>]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>注意：如果 Dockerfile 中如果存在多个 CMD 指令，仅最后一个生效。</p></blockquote><h3 id="2-2-6-EXPOSE"><a href="#2-2-6-EXPOSE" class="headerlink" title="2.2.6 EXPOSE"></a>2.2.6 EXPOSE</h3><p>指定于外界交互的<code>端口</code>。</p><h4 id="2-2-6-1-格式"><a href="#2-2-6-1-格式" class="headerlink" title="2.2.6.1 格式"></a>2.2.6.1 格式</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token comment"># 格式：</span>
<span class="token instruction"><span class="token keyword">EXPOSE</span> &lt;port> [&lt;port>...]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="2-2-6-2-举例"><a href="#2-2-6-2-举例" class="headerlink" title="2.2.6.2 举例"></a>2.2.6.2 举例</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">EXPOSE</span> 80 443</span>
<span class="token instruction"><span class="token keyword">EXPOSE</span> 8080    </span>
<span class="token instruction"><span class="token keyword">EXPOSE</span> 11211/tcp 11214/udp</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>注：<br>EXPOSE并不会让容器的端口访问到主机。要使其可访问，需要在<code>docker run</code>运行容器时通过<code>-p</code>来发布这些端口，或通过<code>-P</code>参数来发布<code>EXPOSE</code><strong>指定的所有端口</strong>。</p><p>如果没有暴露端口，后期也可以通过<code>-p 8080:80</code>方式映射端口，但是<strong>不能</strong>通过<code>-P</code>形式映射.</p></blockquote><h3 id="2-2-7-ADD"><a href="#2-2-7-ADD" class="headerlink" title="2.2.7 ADD"></a>2.2.7 ADD</h3><p>将本地文件添加到容器中，tar类型文件会自动解压(网络压缩资源不会被解压)，可以访问网络资源，类似wget</p><h4 id="2-2-7-1-格式"><a href="#2-2-7-1-格式" class="headerlink" title="2.2.7.1 格式"></a>2.2.7.1 格式</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">ADD</span> &lt;src>... &lt;dest></span>
<span class="token instruction"><span class="token keyword">ADD</span> [<span class="token string">"&lt;src>"</span>,... <span class="token string">"&lt;dest>"</span>] 用于支持包含空格的路径</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="2-2-7-2-举例"><a href="#2-2-7-2-举例" class="headerlink" title="2.2.7.2 举例"></a>2.2.7.2 举例</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token comment"># 添加所有以"hom"开头的文件</span>
<span class="token instruction"><span class="token keyword">ADD</span> hom* /mydir/</span>

<span class="token comment"># ? 替代一个单字符,例如："home.txt"</span>
<span class="token instruction"><span class="token keyword">ADD</span> hom?.txt /mydir/</span>

<span class="token comment"># 添加 "test" 到 `WORKDIR`/relativeDir/</span>
<span class="token instruction"><span class="token keyword">ADD</span> test relativeDir/</span>

<span class="token comment"># 添加 "test" 到 /absoluteDir/</span>
<span class="token instruction"><span class="token keyword">ADD</span> test /absoluteDir/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-2-8-COPY"><a href="#2-2-8-COPY" class="headerlink" title="2.2.8 COPY"></a>2.2.8 COPY</h3><p>类似ADD，但是是不会自动解压文件，也不能访问网络资源。</p><h4 id="2-2-8-1-格式"><a href="#2-2-8-1-格式" class="headerlink" title="2.2.8.1 格式"></a>2.2.8.1 格式</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token comment"># &lt;dest> 是绝对路径，或相对于 WORKDIR 的路径</span>
<span class="token instruction"><span class="token keyword">COPY</span> [--chown=&lt;user>:&lt;group>] [--chmod=&lt;perms>] &lt;src>... &lt;dest></span>
<span class="token comment"># 这种形式对于包含空格的路径是必需的</span>
<span class="token instruction"><span class="token keyword">COPY</span> [--chown=&lt;user>:&lt;group>] [--chmod=&lt;perms>] [<span class="token string">"&lt;src>"</span>,... <span class="token string">"&lt;dest>"</span>]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>注意：<code>--chown</code>和<code>--chmod</code>功能仅在用于生成 Linux 容器的Dockerfile上受支持，在 Windows 容器上不起作用。</p></blockquote><h4 id="2-2-8-2-举例"><a href="#2-2-8-2-举例" class="headerlink" title="2.2.8.2 举例"></a>2.2.8.2 举例</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token comment"># 要添加所有以“hom”开头的文件：</span>
<span class="token instruction"><span class="token keyword">COPY</span> hom* /mydir/</span>

<span class="token comment"># ?替换为任何单个字符，例如“home.txt”</span>
<span class="token instruction"><span class="token keyword">COPY</span> hom?.txt /mydir/</span>

<span class="token comment"># 下面的示例使用相对路径，并将“test.txt”添加到 &lt;WORKDIR>/relativeDir/ </span>
<span class="token instruction"><span class="token keyword">COPY</span> test.txt relativeDir/</span>

<span class="token comment"># 此示例使用绝对路径，并将“test.txt”添加到 /absoluteDir/</span>
<span class="token instruction"><span class="token keyword">COPY</span> test.txt /absoluteDir/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-2-9-VOLUME"><a href="#2-2-9-VOLUME" class="headerlink" title="2.2.9 VOLUME"></a>2.2.9 VOLUME</h3><p>指定持久化目录（指定此目录可以被挂载出去）。数据卷的使用，类似于 Linux 下对目录或文件进行<code>mount</code>。</p><h4 id="2-2-9-1-格式"><a href="#2-2-9-1-格式" class="headerlink" title="2.2.9.1 格式"></a>2.2.9.1 格式</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">VOLUME</span> [<span class="token string">"/path/to/to"</span>]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2-2-9-2-举例"><a href="#2-2-9-2-举例" class="headerlink" title="2.2.9.2 举例"></a>2.2.9.2 举例</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">VOLUME</span> [<span class="token string">"/data"</span>]</span>
<span class="token instruction"><span class="token keyword">VOLUME</span> [<span class="token string">"/var/www"</span>, <span class="token string">"/var/log/apache2"</span>, <span class="token string">"/etc/apache/user"</span>]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>注：一个卷可以存在于一个或多个容器的指定目录，该目录可以绕过联合文件系统，并具有以下功能：</p><ul><li>卷可以<code>容器间</code>共享和重用</li><li>容器并不一定要和其它容器共享卷</li><li>修改卷后会立即生效</li><li>对卷的修改<strong>不会</strong>对<code>镜像</code>产生影响</li><li>卷会一直存在，直到没有任何容器在使用它</li></ul><h3 id="2-2-10-WORKDIR"><a href="#2-2-10-WORKDIR" class="headerlink" title="2.2.10 WORKDIR"></a>2.2.10 WORKDIR</h3><p>工作目录，类似于cd命令</p><h4 id="2-2-10-1-格式"><a href="#2-2-10-1-格式" class="headerlink" title="2.2.10.1 格式"></a>2.2.10.1 格式</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">WORKDIR</span> /path/to/workdir</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2-2-10-2-举例"><a href="#2-2-10-2-举例" class="headerlink" title="2.2.10.2 举例"></a>2.2.10.2 举例</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token comment"># 这时工作目录为/a</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /a</span>
<span class="token comment"># 这时工作目录为/a/b</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> b</span>
<span class="token comment"># 这时工作目录为/a/b/c</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> c</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>也就是说，如果有多个<code>WORKDIR</code>，那最终的路径就是从上到下，如：/a/b/c，类似这样。</p><blockquote><p>注：</p><ul><li>通过WORKDIR设置工作目录后，Dockerfile中其后的命令<code>RUN</code>、<code>CMD</code>、<code>ENTRYPOINT</code>、<code>ADD</code>、<code>COPY</code>等命令都会在该目录下执行。</li><li>在使用docker run运行容器时，可以通过<code>-w</code>参数覆盖构建时所设置的工作目录。</li></ul></blockquote><h3 id="2-2-11-ENTRYPOINT"><a href="#2-2-11-ENTRYPOINT" class="headerlink" title="2.2.11 ENTRYPOINT"></a>2.2.11 ENTRYPOINT</h3><p>配置容器，使其可执行化。</p><h4 id="2-2-11-1-格式"><a href="#2-2-11-1-格式" class="headerlink" title="2.2.11.1 格式"></a>2.2.11.1 格式</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token comment"># 可执行文件, 优先</span>
<span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">"executable"</span>, <span class="token string">"param1"</span>, <span class="token string">"param2"</span>]</span>
<span class="token comment"># shell内部命令</span>
<span class="token instruction"><span class="token keyword">ENTRYPOINT</span> command param1 param2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-2-11-2-举例"><a href="#2-2-11-2-举例" class="headerlink" title="2.2.11.2 举例"></a>2.2.11.2 举例</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">FROM</span> centos:7</span>
<span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">"ls"</span>, <span class="token string">"/usr/local"</span>]</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"/usr/local/tomcat"</span>]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>之后，<code>docker run</code>传递的参数，都会先覆盖<code>cmd</code>，然后由cmd传递给<code>entrypoint</code> ,做到灵活应用。</p><blockquote><p>注：<code>ENTRYPOINT</code>与<code>CMD</code>非常类似，不同的是通过<code>docker run</code>执行的命令<strong>不会覆盖</strong>ENTRYPOINT，而docker run命令中指定的任何参数，都会被当做参数再次传递给<code>CMD</code>。</p><p>Dockerfile中<strong>只允许有一个ENTRYPOINT命令</strong>，多个指定时会覆盖前面的设置，而只执行最后的ENTRYPOINT指令。<br>通常情况下，<code>ENTRYPOINT</code>与<code>CMD</code>一起使用，<code>ENTRYPOINT</code>写默认命令，当需要参数时候使用<code>CMD</code>传参。</p></blockquote><h1 id="3-实践"><a href="#3-实践" class="headerlink" title="3 实践"></a>3 实践</h1><h2 id="3-1-dockerfile编写"><a href="#3-1-dockerfile编写" class="headerlink" title="3.1 dockerfile编写"></a>3.1 dockerfile编写</h2><p>以我自己开发的聊天软件中的一个项目为例，实质上为一个Spring Cloud Gateway网关。以下为其dockerfile：<br><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token comment"># 拉取JDK</span>
<span class="token instruction"><span class="token keyword">FROM</span> openjdk:8-jdk-alpine</span>
<span class="token comment"># 挂在/tmp卷下</span>
<span class="token instruction"><span class="token keyword">VOLUME</span> /tmp</span>
<span class="token comment"># 将taeyeonim-gateway.jar添加进容器</span>
<span class="token instruction"><span class="token keyword">ADD</span> taeyeonim-gateway.jar taeyeonim-gateway.jar</span>
<span class="token comment"># java -jar启动</span>
<span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">"java"</span>,<span class="token string">"-Djava.security.egd=file:/dev/./urandom"</span>,<span class="token string">"-jar"</span>,<span class="token string">"/taeyeonim-gateway.jar"</span>]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><p>这里ADD的时候，很容易出错，因为一般dockerfile在项目中不会与源文件，如*.jar放在一起，所以容易出现<code>Dockerfile ADD failed : No Source files were specified</code>，比如下面这种错误：<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Deploying <span class="token string">'&lt;unknown> Dockerfile: taeyeonim-gateway/src/main/docker/dockerfile'</span>…
Building image…
Preparing build context archive…
<span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">></span><span class="token punctuation">]</span><span class="token number">1</span>/1 files
Done

Sending build context to Docker daemon…
<span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">></span><span class="token punctuation">]</span>  <span class="token number">288</span>.0B
Done

Step <span class="token number">1</span>/4 <span class="token builtin class-name">:</span> FROM openjdk:8-jdk-alpine
 ---<span class="token operator">></span> a3562aa0b991
Step <span class="token number">2</span>/4 <span class="token builtin class-name">:</span> VOLUME /tmp
 ---<span class="token operator">></span> Using cache
 ---<span class="token operator">></span> 0b0f08654eb9
Step <span class="token number">3</span>/4 <span class="token builtin class-name">:</span> ADD taeyeonim-gateway.jar taeyeonim-gateway.jar
Error response from daemon: ADD failed: <span class="token function">file</span> not found <span class="token keyword">in</span> build context or excluded by .dockerignore: <span class="token function">stat</span> taeyeonim-gateway.jar: <span class="token function">file</span> does not exist
Failed to deploy <span class="token string">'&lt;unknown> Dockerfile: taeyeonim-gateway/src/main/docker/dockerfile'</span><span class="token builtin class-name">:</span> Can't retrieve image ID from build stream
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>即使配置全路径也不能解决。为啥呢？</p><p>原因呢很简单，ADD 命令用来从<code>context上下文</code>复制新文件、目录或远程文件url，并将它们添加到位于指定路径的映像文件系统中。所以如果dockerfile和源文件在同一个目录下就不会出现上述错误。</p><p>在IDEA中，对于两文件分别在不同目录的情况，可以通过指定<code>context folder</code>，使其指向target解决此问题。如下图所示（IDEA版本：IntelliJ IDEA 2021.3 (Ultimate Edition)）：<br><img src="https://gcore.jsdelivr.net/gh/zyxelva/picgo/markdown/docker-add-failed-config.png"></p><div class="caption"><b class="center-caption">指定 jar 包的路径</b></div><p></p><h2 id="3-2-构建镜像"><a href="#3-2-构建镜像" class="headerlink" title="3.2 构建镜像"></a>3.2 构建镜像</h2><p>上图中，我们可以看到已经配置了镜像的Tag，则构建镜像的命令行形式如下：<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> build <span class="token parameter variable">-f</span> dockerfile <span class="token parameter variable">-t</span> im-gateway:v2 <span class="token builtin class-name">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><ul><li><code>-t</code>：用于指定镜像的名称为im-gateway:v2；</li><li><code>.</code>：表示使用当前目录下的Dockerfile进行构建。</li></ul><p>名称可以以<code>name:version</code>的形式指定，<code>name</code>和<code>version</code>之间用<code>冒号</code>分隔。如果没有指定版本，则默认为<code>latest</code>。</p><p>构建日志如下所示：<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Deploying <span class="token string">'im-gateway:v2 Dockerfile: taeyeonim-gateway/src/main/docker/dockerfile'</span>…
Building image…
Preparing build context archive…
<span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">></span><span class="token punctuation">]</span><span class="token number">33</span>/33 files
Done

Sending build context to Docker daemon…
<span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">></span><span class="token punctuation">]</span> <span class="token number">82</span>.20MB
Done

Step <span class="token number">1</span>/4 <span class="token builtin class-name">:</span> FROM openjdk:8-jdk-alpine
 ---<span class="token operator">></span> a3562aa0b991
Step <span class="token number">2</span>/4 <span class="token builtin class-name">:</span> VOLUME /tmp
 ---<span class="token operator">></span> Using cache
 ---<span class="token operator">></span> 3c8fa2e5827c
Step <span class="token number">3</span>/4 <span class="token builtin class-name">:</span> ADD taeyeonim-gateway.jar taeyeonim-gateway.jar
 ---<span class="token operator">></span> Using cache
 ---<span class="token operator">></span> cb2f85399674
Step <span class="token number">4</span>/4 <span class="token builtin class-name">:</span> ENTRYPOINT <span class="token punctuation">[</span><span class="token string">"java"</span>,<span class="token string">"-Djava.security.egd=file:/dev/./urandom"</span>,<span class="token string">"-jar"</span>,<span class="token string">"/taeyeonim-gateway.jar"</span><span class="token punctuation">]</span>
 ---<span class="token operator">></span> Using cache
 ---<span class="token operator">></span> 655e3800a65c

Successfully built 655e3800a65c
Successfully tagged im-gateway:v2
<span class="token string">'im-gateway:v2 Dockerfile: taeyeonim-gateway/src/main/docker/dockerfile'</span> has been deployed successfully.
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><p>通过docker客户端或者IDEA自带的工具都可以看到构建镜像成功后的镜像列表。<br><img src="https://gcore.jsdelivr.net/gh/zyxelva/picgo/markdown/docker-client-image-list.png"></p><div class="caption"><b class="center-caption">docker客户端镜像列表</b></div><p></p><p>IDEA镜像列表：<br><img src="https://gcore.jsdelivr.net/gh/zyxelva/picgo/markdown/docker-idea-image-list.png"></p><div class="caption"><b class="center-caption">IDEA docker镜像列表</b></div><p></p><h2 id="3-3-创建容器"><a href="#3-3-创建容器" class="headerlink" title="3.3 创建容器"></a>3.3 创建容器</h2><p>两种方式创建容器，一种是通过docker客户端进行创建，一种是通过IDEA创建。</p><h3 id="3-3-1-docker-client方式"><a href="#3-3-1-docker-client方式" class="headerlink" title="3.3.1 docker client方式"></a>3.3.1 docker client方式</h3><p>找到image列表中之前构建的Gateway镜像，点击<code>Run</code>按钮，弹出菜单。<br><img src="https://gcore.jsdelivr.net/gh/zyxelva/picgo/markdown/docker-client-container.png"></p><div class="caption"><b class="center-caption">docker客户端方式创建容器</b></div><p></p><p>填写好容器名称，这里我命名为<code>Im-Gw</code>。<br><img src="https://gcore.jsdelivr.net/gh/zyxelva/picgo/markdown/docker-client-container-config.png"></p><div class="caption"><b class="center-caption">docker客户端方式创建容器-配置</b></div><p></p><p>点击<code>Run</code>，开始启动容器，成功后可以在容器列表看到。<br><img src="https://gcore.jsdelivr.net/gh/zyxelva/picgo/markdown/docker-client-container-run.png"></p><div class="caption"><b class="center-caption">docker客户端方式创建容器-启动</b></div><p></p><h3 id="3-3-2-IDEA方式"><a href="#3-3-2-IDEA方式" class="headerlink" title="3.3.2 IDEA方式"></a>3.3.2 IDEA方式</h3><p>找到IDEA services窗口，查看image列表，找到之前构建的镜像<code>im-gateway</code>，右键弹出菜单，选中<code>create container</code>。<br><img src="https://gcore.jsdelivr.net/gh/zyxelva/picgo/markdown/docker-idea-container-create.png"></p><div class="caption"><b class="center-caption">IDEA方式创建容器</b></div><p></p><p>填写容器名称，这里为<code>IM-Gateway</code>. 点击<code>run</code>运行容器。<br><img src="https://gcore.jsdelivr.net/gh/zyxelva/picgo/markdown/docker-idea-container-config.png"></p><div class="caption"><b class="center-caption">IDEA方式创建容器-配置</b></div><p></p><p>同样可以在docker客户端看到启动成功后的docker，如3.3.1节中的容器列表图，也可以在IDEA中查看，只是没有那么好看。哈哈哈哈<br><img src="https://gcore.jsdelivr.net/gh/zyxelva/picgo/markdown/docker-idea-container-list2.png"></p><div class="caption"><b class="center-caption">IDEA方式创建容器-查看</b></div><p></p><h1 id="4-参考文献"><a href="#4-参考文献" class="headerlink" title="4 参考文献"></a>4 参考文献</h1><ul><li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdocs.docker.com%2Fengine%2Freference%2Fbuilder%2F%23environment-replacement">Dockerfile reference</a></li><li><a target="_blank" rel="noopener" href="https://quickref.me/zh-CN/docs/dockerfile.html">Dockerfile 备忘清单</a></li><li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/152957068">Docker ARG，ENV和.env-完整指南</a></li><li><a target="_blank" rel="noopener" href="https://vsupalov.com/docker-arg-env-variable-guide/">Docker ARG, ENV and .env - a Complete Guide</a></li></ul></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">文章作者:</i></span> <span class="reprint-info"><a href="/about" rel="external nofollow noreferrer">Kezade</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">文章链接:</i></span> <span class="reprint-info"><a href="https://zyxelva.github.io/posts/342586947.html">https://zyxelva.github.io/posts/342586947.html</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">版权声明:</i></span> <span class="reprint-info">本博客所有文章除特別声明外，均采用 <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> 许可协议。转载请注明来源 <a href="/about" target="_blank">Kezade</a> !</span></div></div><script async defer>function navToReprintStatement(){$("html, body").animate({scrollTop:$("#reprint-statement").offset().top-80},800)}document.addEventListener("copy",function(t){M.toast({html:'<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>'})})</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/Docker/"><span class="chip bg-color">Docker</span></a> <a href="/tags/Dockerfile/"><span class="chip bg-color">Dockerfile</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/share/js/social-share.min.js"></script></div></div></div><div id="reward"><a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close modal-close"><i class="fas fa-times"></i></a><h4 class="reward-title">你的赏识是我前进的动力</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs row"><li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li><li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li></ul><div id="alipay"><img src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码"></div><div id="wechat"><img src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码"></div></div></div></div></div></div><script>$(function(){$(".tabs").tabs()})</script></div></div><style>.twikoo-card{margin:1.5rem auto}.twikoo-card .card-content{padding:20px}#tcomments textarea{box-sizing:border-box;background:url("/") 100% 100% no-repeat}#tcomments p{margin:2px 2px 10px;font-size:1.05rem;line-height:1.78rem;text-align:left}#tcomments blockquote p{text-indent:.2rem}#tcomments a{padding:0 2px;color:#4cbf30;font-weight:500;text-decoration:none}#tcomments img{max-width:100%;height:auto;cursor:pointer}#tcomments ol li{list-style-type:decimal}#tcomments ol,ul{display:block;padding-left:2em;word-spacing:0.05rem}#tcomments ul li,ol li{display:list-item;line-height:1.8rem;font-size:1rem}#tcomments ul li{list-style-type:disc}#tcomments ul ul li{list-style-type:circle}#tcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}#tcomments table,td,th{border:0}table tr:nth-child(2n),thead{background-color:#fafafa}#tcomments table th{background-color:#f2f2f2;min-width:80px}#tcomments table td{min-width:80px}#tcomments h1{font-size:1.85rem;font-weight:700;line-height:2.2rem}#tcomments h2{font-size:1.65rem;font-weight:700;line-height:1.9rem}#tcomments h3{font-size:1.45rem;font-weight:700;line-height:1.7rem}#tcomments h4{font-size:1.25rem;font-weight:700;line-height:1.5rem}#tcomments h5{font-size:1.1rem;font-weight:700;line-height:1.4rem}#tcomments h6{font-size:1rem;line-height:1.3rem}#tcomments p{font-size:1rem;line-height:1.5rem}#tcomments hr{margin:12px 0;border:0;border-top:1px solid #ccc}#tcomments blockquote{margin:15px 0;border-left:5px solid #42b983;padding:1rem .8rem .3rem .8rem;color:#666;background-color:rgba(66,185,131,.1)}#tcomments pre{font-family:monospace,monospace;padding:1.2em;margin:.5em 0;background:#272822;overflow:auto;border-radius:.3em;tab-size:4}#tcomments code{font-family:monospace,monospace;padding:1px 3px;font-size:.92rem;color:#e96900;background-color:#f8f8f8;border-radius:2px}#tcomments pre code{font-family:monospace,monospace;padding:0;color:#e8eaf6;background-color:#272822}#tcomments pre[class*=language-]{padding:1.2em;margin:.5em 0}#tcomments code[class*=language-],pre[class*=language-]{color:#e8eaf6}#tcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}#tcomments b,strong{font-weight:700}#tcomments dfn{font-style:italic}#tcomments small{font-size:85%}#tcomments cite{font-style:normal}#tcomments mark{background-color:#fcf8e3;padding:.2em}#tcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}table tr:nth-child(2n),thead{background-color:#fafafa}#tcomments table th{background-color:#f2f2f2;min-width:80px}#tcomments table td{min-width:80px}#tcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}</style><div class="card twikoo-card" data-aos="fade-up"><div class="comment_headling" style="font-size:20px;font-weight:700;position:relative;padding-left:20px;top:15px;padding-bottom:5px"><i class="fas fa-comments fa-fw" aria-hidden="true"></i> <span>评论</span></div><div class="card-content" style="display:grid"><div id="tcomments"></div></div></div><script src="https://gcore.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js"></script><script>twikoo.init({envId:"https://kezadetwikoo.netlify.app/.netlify/functions/twikoo",el:"#tcomments",region:"",path:""}).then(function(){for(var t=document.querySelector("#twikoo").getElementsByTagName("input"),e=0;e<t.length;e++)t[e]&&t[e].classList.add("browser-default")})</script><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i> &nbsp;上一篇</div><div class="card"><a href="/posts/1784156720.html"><div class="card-image"><img src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/medias/featureimages/22.jpg" class="responsive-img" alt="【Docker学习】4.与Dockerfile优化有关的5个小技巧"> <span class="card-title">【Docker学习】4.与Dockerfile优化有关的5个小技巧</span></div></a><div class="card-content article-content"><div class="summary block-with-text"></div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i> 2024-01-18</span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/Docker%E5%AD%A6%E4%B9%A0/" class="post-category">Docker学习</a></span></div></div><div class="card-action article-tags"><a href="/tags/Docker/"><span class="chip bg-color">Docker</span></a> <a href="/tags/Dockerfile/"><span class="chip bg-color">Dockerfile</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/posts/1372686241.html"><div class="card-image"><img src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/medias/featureimages/19.jpg" class="responsive-img" alt="【Docker学习】2.命令备忘"> <span class="card-title">【Docker学习】2.命令备忘</span></div></a><div class="card-content article-content"><div class="summary block-with-text"></div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i> 2023-12-19</span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/Docker%E5%AD%A6%E4%B9%A0/" class="post-category">Docker学习</a></span></div></div><div class="card-action article-tags"><a href="/tags/Docker/"><span class="chip bg-color">Docker</span></a></div></div></div></div></article></div><script>$("#articleContent").on("copy",function(e){if(void 0!==window.getSelection){var n=window.getSelection();if(!((""+n).length<Number.parseInt("120"))){var t=document.getElementsByTagName("body")[0],o=document.createElement("div");o.style.position="absolute",o.style.left="-99999px",t.appendChild(o),o.appendChild(n.getRangeAt(0).cloneContents()),"PRE"!==n.getRangeAt(0).commonAncestorContainer.nodeName&&"CODE"!==n.getRangeAt(0).commonAncestorContainer.nodeName||(o.innerHTML="<pre>"+o.innerHTML+"</pre>");var i=document.location.href;o.innerHTML+='<br />来源: Kezade<br />文章作者: Kezade<br />文章链接: <a href="'+i+'">'+i+"</a><br />本文章著作权归作者所有，任何形式的转载都请注明出处。",n.selectAllChildren(o),window.setTimeout(function(){t.removeChild(o)},200)}}})</script><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/codeBlock/codeBlockFuction.js"></script><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/prism/prism.min.js"></script><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/codeBlock/codeLang.js"></script><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/codeBlock/codeCopy.js"></script><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/codeBlock/codeShrink.js"></script></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget card" style="background-color:#fff"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/tocbot/tocbot.min.js"></script><script>$(function(){tocbot.init({tocSelector:"#toc-content",contentSelector:"#articleContent",headingsOffset:-(.4*$(window).height()-45),collapseDepth:Number("0"),headingSelector:"h1, h2, h3, h4, h5"});let t=parseInt(.4*$(window).height()-64),e=$(".toc-widget");$(window).scroll(function(){$(window).scrollTop()>t?e.addClass("toc-fixed"):e.removeClass("toc-fixed")});const o="expanded";let n=$("#toc-aside"),i=$("#main-content");$("#floating-toc-btn .btn-floating").click(function(){n.hasClass(o)?(n.removeClass(o).hide(),i.removeClass("l9")):(n.addClass(o).show(),i.addClass("l9")),function(t,e){let o=$("#"+t);if(0===o.length)return;let n=o.width();n+=n>=450?21:n>=350&&n<450?18:n>=300&&n<350?16:14,$("#"+e).width(n)}("artDetail","prenext-posts")})})</script></main><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}})</script><footer class="page-footer bg-color"><div class="container row center-align" style="margin-bottom:15px!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2019-2025</span> <a href="/about" target="_blank">Kezade</a> |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a> |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a><br><br><span id="sitetime">Loading ...</span><script>var calcSiteTime=function(){var e=6e4,t=36e5,n=864e5,a=365*n,i=new Date,r="2019",o=i.getFullYear(),s=i.getMonth()+1,l=i.getDate(),m=i.getHours(),c=i.getMinutes(),d=i.getSeconds(),g=Date.UTC(r,"6","28","0","0","0"),h=Date.UTC(o,s,l,m,c,d)-g,u=Math.floor(h/a),M=Math.floor(h/n-365*u),T=Math.floor((h-(365*u+M)*n)/t),f=Math.floor((h-(365*u+M)*n-T*t)/e),y=Math.floor((h-(365*u+M)*n-T*t-f*e)/1e3);if(r===String(o)){document.getElementById("year").innerHTML=o;var v="This site has been running for "+M+" days";v="本站已运行 "+M+" 天",document.getElementById("sitetime").innerHTML=v}else{document.getElementById("year").innerHTML=r+" - "+o;var H="This site has been running for "+u+" years and "+M+" days "+T+" hours "+f+" mins "+y+" seconds";H="本站已苟且偷生 "+u+" 年 "+M+" 天 "+T+" 小时 "+f+" 分钟 "+y+" 秒",document.getElementById("sitetime").innerHTML=H}};calcSiteTime(),setInterval(calcSiteTime,1e3)</script><br></div><div class="col s12 m4 l4 social-link"><a href="https://github.com/zyxelva" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i></a><a href="mailto:zyxelva@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope-open"></i></a><a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1807401971" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1807401971" data-position="top" data-delay="50"><i class="fab fa-qq"></i></a> <a href="https://www.zhihu.com/people/kezade" class="tooltipped" target="_blank" data-tooltip="关注我的知乎: https://www.zhihu.com/people/kezade" data-position="top" data-delay="50"><i class="fab fa-zhihu1">知</i></a><a href="../rss2.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fas fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i> &nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script>$(function(){!function(t,e,r){"use strict";$.ajax({url:t,dataType:"xml",success:function(t){var n=$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),a=document.getElementById(e),s=document.getElementById(r);a.addEventListener("input",function(){var t='<ul class="search-result-list">',e=this.value.trim().toLowerCase().split(/[\s\-]+/);s.innerHTML="",this.value.trim().length<=0||(n.forEach(function(r){var n=!0,a=r.title.trim().toLowerCase(),s=r.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),i=r.url;i=0===i.indexOf("/")?r.url:"/"+i;var l=-1,c=-1,u=-1;if(""!==a&&""!==s&&e.forEach(function(t,e){l=a.indexOf(t),c=s.indexOf(t),l<0&&c<0?n=!1:(c<0&&(c=0),0===e&&(u=c))}),n){t+="<li><a href='"+i+"' class='search-result-title'>"+a+"</a>";var o=r.content.trim().replace(/<[^>]+>/g,"");if(u>=0){var h=u-20,f=u+80;h<0&&(h=0),0===h&&(f=100),f>o.length&&(f=o.length);var m=o.substr(h,f);e.forEach(function(t){var e=new RegExp(t,"gi");m=m.replace(e,'<em class="search-keyword">'+t+"</em>")}),t+='<p class="search-result">'+m+"...</p>"}t+="</li>"}}),t+="</ul>",s.innerHTML=t)})}})}("/search.xml","searchInput","searchResult")})</script><div class="stars-con"><div id="stars"></div><div id="stars2"></div><div id="stars3"></div></div><script>function switchNightMode(){$('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($("body")),setTimeout(function(){$("body").hasClass("DarkMode")?($("body").removeClass("DarkMode"),localStorage.setItem("isDark","0"),$("#sum-moon-icon").removeClass("fa-sun").addClass("fa-moon")):($("body").addClass("DarkMode"),localStorage.setItem("isDark","1"),$("#sum-moon-icon").addClass("fa-sun").removeClass("fa-moon")),setTimeout(function(){$(".Cuteen_DarkSky").fadeOut(1e3,function(){$(this).remove()})},2e3)})}</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/materialize/materialize.min.js"></script><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/masonry/masonry.pkgd.min.js"></script><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/aos/aos.js"></script><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/scrollprogress/scrollProgress.min.js"></script><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/js/matery.js"></script><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/mermaid/mermaid.min.css"><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/mermaid/mermaid.min.js"></script><script>window.mermaid&&mermaid.initialize({theme:"forest"})</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/background/ribbon-dynamic.js" async></script><script src="https://gcore.jsdelivr.net/gh/zyxelva/zyxelva.github.io@main/libs/instantpage/instantpage.js" type="module"></script></body></html>